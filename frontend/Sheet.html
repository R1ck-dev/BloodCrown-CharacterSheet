<!DOCTYPE html>
<html lang="pt-BR" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editando Ficha | BloodCrown</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/Sheet.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

</head>
<body class="bg-black text-light"> <main class="container-fluid p-4">
        
        <form id="sheetForm">
            
            <header class="row align-items-end mb-4 p-3 rounded custom-header">
                <div class="col-md-3">
                    <label class="text-secondary small">PERSONAGEM</label>
                    <input type="text" id="charName" class="form-control rpg-input" placeholder="Nome do Personagem">
                </div>
                <div class="col-md-3">
                    <label class="text-secondary small">CLASSE</label>
                    <input type="text" id="charClass" class="form-control rpg-input" placeholder="Ex: Irregular">
                </div>
                <div class="col-md-2">
                    <label class="text-secondary small">Nível</label>
                    <input type="number" id="charLevel" class="form-control rpg-input" placeholder="5">
                </div>
                <div class="col-md-4 text-end">
                    <a href="Dashboard.html" class="btn btn-outline-secondary me-2">Sair</a>
                    <button id="btnSave" class="btn btn-purple">SALVAR</button>
                </div>
            </header>

            <div class="row g-4">
                
                <div class="col-lg-3 d-flex flex-column gap-4">
                    
                    <div class="attributes-box text-center">
                        <h5 class="text-secondary mb-3">ATRIBUTOS</h5>
                        
                        <div class="attributes-grid">

                            <div class="attr-circle">
                                <label>DES</label>
                                <input type="text" id="attrDestreza" value="1">
                            </div>

                            <div class="attr-circle">
                                <label>FOR</label>
                                <input type="text" id="attrForca" value="1">
                            </div>

                            <div class="attr-circle">
                                <label>INT</label>
                                <input type="text" id="attrInteligencia" value="1">
                            </div>

                            <div class="attr-circle">
                                <label>CAR</label>
                                <input type="text" id="attrCarisma" value="1">
                            </div>

                            <div class="attr-circle">
                                <label>COS</label>
                                <input type="text" id="attrConstituicao" value="1">
                            </div>

                            <div class="attr-circle">
                                <label>SAB</label>
                                <input type="text" id="attrSabedoria" value="1">
                            </div>

                        </div>

                    </div>

                    <div class="status-box">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="text-danger fw-bold">VIDA</span>

                            <div class="d-flex align-items-center gap-1">
                                <input id="statusHealthCurrent" type="number" class="status-input">
                                <span>/</span>
                                <input id="statusMaxHealth" type="number" class="status-input">
                            </div>
                        </div>

                        <div class="progress">
                            <div id="barHealth" class="progress-bar bg-danger"></div>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="text-info fw-bold">SANIDADE</span>

                            <div class="d-flex align-items-center gap-1">
                                <input id="statusSanityCurrent" type="number" class="status-input">
                                <span>/</span>
                                <input id="statusMaxSanity" type="number" class="status-input">
                            </div>
                        </div>

                        <div class="progress">
                            <div id="barSanity" class="progress-bar bg-info"></div>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="text-success fw-bold">MANA</span>

                            <div class="d-flex align-items-center gap-1">
                                <input id="statusManaCurrent" type="number" class="status-input">
                                <span>/</span>
                                <input id="statusMaxMana" type="number" class="status-input">
                            </div>
                        </div>

                        <div class="progress">
                            <div id="barMana" class="progress-bar bg-success"></div>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="text-warning fw-bold">ESTAMINA</span>

                            <div class="d-flex align-items-center gap-1">
                                <input id="statusStaminaCurrent" type="number" class="status-input">
                                <span>/</span>
                                <input id="statusMaxStamina" type="number" class="status-input">
                            </div>
                        </div>

                        <div class="progress">
                            <div id="barStamina" class="progress-bar bg-warning"></div>
                        </div>
                    </div>

                    <div class="defense-card d-flex flex-column align-items-center p-3 border border-secondary rounded bg-dark">
                        
                        <div class="position-relative text-center mb-2">
                            <i class="fa-solid fa-shield text-secondary" style="font-size: 3.5rem;"></i>
                            <div class="position-absolute top-50 start-50 translate-middle">
                                <input type="text" id="statusDefense" class="fw-bold text-center bg-transparent border-0 text-white" 
                                    style="width: 50px; font-size: 1.4rem;" readonly value="10">
                            </div>
                        </div>
                        
                        <div class="defense-formula d-flex align-items-center justify-content-center gap-1 text-muted" style="font-size: 0.8rem;">
                            
                            <div class="text-center">
                                <input type="number" id="defBase" class="formula-input text-secondary" value="10" title="Base">
                                <div style="font-size: 0.6rem;">BASE</div>
                            </div>
                            <span>+</span>
                            
                            <div class="text-center">
                                <span id="defDexDisplay" class="fw-bold text-light">0</span>
                                <div style="font-size: 0.6rem;">DES</div>
                            </div>
                            <span>+</span>

                            <div class="text-center">
                                <input type="number" id="defArmor" class="formula-input text-info" placeholder="0" title="Armadura">
                                <div style="font-size: 0.6rem;">ARM</div>
                            </div>
                            <span>+</span>

                            <div class="text-center">
                                <input type="number" id="defOther" class="formula-input text-warning" placeholder="0" title="Outros">
                                <div style="font-size: 0.6rem;">OUT</div>
                            </div>
                        </div>
                    </div>

                </div> <div class="col-lg-5">
                    <div class="card bg-dark border-secondary h-100">
                        <div class="card-header border-secondary bg-transparent">
                            <h5 class="m-0 text-center">PERÍCIAS</h5>
                        </div>
                        <div class="card-body p-0 overflow-auto" style="max-height: 700px;">
                            <table class="table table-dark table-striped table-hover m-0 align-middle">
                                <thead>
                                    <tr>
                                        <th class="ps-4">Nome</th>
                                        <th class="text-center">Valor</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td class="ps-4">Atletismo (FOR)</td><td class="text-center"><input type="text" id="skillAtletismo" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Conhecimento (INT)</td><td class="text-center"><input type="text" id="skillConhecimento" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Consertar (INT)</td><td class="text-center"><input type="text" id="skillConsertar" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Diplomacia (CAR)</td><td class="text-center"><input type="text" id="skillDiplomacia" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Domar (CAR)</td><td class="text-center"><input type="text" id="skillDomar" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Empatia (CAR)</td><td class="text-center"><input type="text" id="skillEmpatia" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Fortitude (COS)</td><td class="text-center"><input type="text" id="skillFortitude" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Furtividade (DES)</td><td class="text-center"><input type="text" id="skillFurtividade" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Iniciativa (DES)</td><td class="text-center"><input type="text" id="skillIniciativa" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Intimidação (CAR)</td><td class="text-center"><input type="text" id="skillIntimidar" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Intuição (SAB)</td><td class="text-center"><input type="text" id="skillIntuicao" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Investigação (INT)</td><td class="text-center"><input type="text" id="skillInvestigacao" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Lábia (CAR)</td><td class="text-center"><input type="text" id="skillLabia" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Ladinagem (DES)</td><td class="text-center"><input type="text" id="skillLadinagem" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Luta (FOR)</td><td class="text-center"><input type="text" id="skillLuta" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Magia (SAB)</td><td class="text-center"><input type="text" id="skillMagia" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Medicina (INT)</td><td class="text-center"><input type="text" id="skillMedicina" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Mente (INT)</td><td class="text-center"><input type="text" id="skillMente" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Percepção (SAB)</td><td class="text-center"><input type="text" id="skillPercepcao" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Pontaria (DES)</td><td class="text-center"><input type="text" id="skillPontaria" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Reflexos (DES)</td><td class="text-center"><input type="text" id="skillReflexos" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Seduzir (CAR)</td><td class="text-center"><input type="text" id="skillSeduzir" class="skill-input"></td></tr>
                                    <tr><td class="ps-4">Sobrevivência (INT)</td><td class="text-center"><input type="text" id="skillSobrevivencia" class="skill-input"></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div> 
                <div class="col-lg-4">
                    
                    <ul class="nav nav-tabs border-secondary small" id="rpgTabs" role="tablist" style="font-size: 0.8rem;">
                        
                        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tabCombat" type="button">COMBATE</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabClass" type="button">HABILIDADES DE CLASSE</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabMagic" type="button">HABILIDADES DE MAGIA</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabAwaken" type="button">HABILIDADES DE DESPERTAR</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabWeapon" type="button">HABILIDADES DE ARMA</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabTrans" type="button">TRANSFORMAÇÃO</button></li> <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabSpecial" type="button">ESPECIAIS</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabInv" type="button">INVENTÁRIO</button></li> <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabDesc" type="button">DESCRIÇÃO</button></li>
                    </ul>

                    <div class="tab-content p-3 border border-top-0 border-secondary bg-dark rounded-bottom custom-scroll" id="rpgTabContent" style="height: 600px; overflow-y: auto;">
    
                        <div class="tab-pane fade show active" id="tabCombat" role="tabpanel">
                            <div class="d-flex justify-content-end mb-3">
                                <button id="btnOpenAttackModal" class="btn btn-outline-danger btn-sm">+ Novo Ataque</button>
                            </div>
                            </div>

                        <div class="tab-pane fade" id="tabClass" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Habilidades de Classe</h6>
                                <button type="button" class="btn btn-sm btn-outline-light" onclick="openAbilityModal('CLASS')">+ Adicionar</button>
                            </div>
                            </div>

                        <div class="tab-pane fade" id="tabMagic" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Grimório</h6>
                                <button type="button" class="btn btn-sm btn-outline-info" onclick="openAbilityModal('MAGIC')">+ Magia</button>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabAwaken" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Poderes de Despertar</h6>
                                <button type="button" class="btn btn-sm btn-outline-warning" onclick="openAbilityModal('AWAKEN')">+ Poder</button>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabWeapon" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Técnicas de Arma</h6>
                                <button type="button" class="btn btn-sm btn-outline-secondary" onclick="openAbilityModal('WEAPON')">+ Técnica</button>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabTrans" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Formas</h6>
                                <button type="button" class="btn btn-sm btn-outline-danger" onclick="openAbilityModal('TRANSFORMATION')">+ Forma</button>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabSpecial" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-secondary m-0">Outros</h6>
                                <button type="button" class="btn btn-sm btn-outline-success" onclick="openAbilityModal('SPECIAL')">+ Especial</button>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabInv" role="tabpanel">
                            <h6 class="text-secondary border-bottom border-secondary pb-2">Mochila</h6>
                            </div>

                        <div class="tab-pane fade" id="tabDesc" role="tabpanel">
                            </div>

                    </div>
                </div> 
            </div>
        </form>

<div id="diceToast" class="dice-toast">
            <div class="dice-header-toast">
                <strong id="rollTitle">Teste de Perícia</strong>
                <span id="closeToast" class="close-toast-btn">&times;</span>
            </div>
            
            <div class="d-flex align-items-center justify-content-between mt-2">
                <div class="dice-info text-secondary small">
                    <div>Dados: <span id="diceRolled" class="text-light"></span></div>
                    <div>Maior: <span id="bestDice" class="text-warning fw-bold"></span></div>
                    <div>Bônus: <span id="modifierValue" class="text-info"></span></div>
                </div>

                <div class="dice-total text-end">
                    <h2 id="finalResult" class="m-0 fw-bold text-purple" style="font-size: 2.5rem; line-height: 1;">20</h2>
                    <small class="text-muted" style="font-size: 0.7rem;">TOTAL</small>
                </div>
            </div>
            <div class="toast-progress-bar"></div>
        </div>

        <div class="modal fade" id="modalNewAttack" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-dark border-secondary text-light">
                    <div class="modal-header border-secondary">
                        <h5 class="modal-title">Novo Ataque</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="formAttack">
                            <div class="mb-3">
                                <label class="form-label text-secondary small">NOME DO ATAQUE</label>
                                <input type="text" id="atkName" class="form-control bg-black text-light border-secondary" placeholder="Ex: Espada Longa">
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label text-secondary small">DANO (Formato: 1d8, 2d6+3)</label>
                                <input type="text" id="atkDamage" class="form-control bg-black text-light border-secondary" placeholder="Ex: 2d8 + 2">
                            </div>

                            <div class="mb-3">
                                <label class="form-label text-secondary small">DESCRIÇÃO</label>
                                <textarea id="atkDesc" class="form-control bg-black text-light border-secondary" rows="2" placeholder="Ex: Rolar Luta + Força."></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer border-secondary">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-purple" id="btnSaveAttack">Criar Ataque</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modalNewAbility" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-dark border-secondary text-light">
                    <div class="modal-header border-secondary">
                        <h5 class="modal-title">Nova Habilidade</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="formAbility">
                            <ul class="nav nav-pills mb-3 gap-2" id="pills-tab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active py-1 px-3 small" id="pills-general-tab" data-bs-toggle="pill" data-bs-target="#pills-general" type="button">Geral</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link py-1 px-3 small" id="pills-mechanic-tab" data-bs-toggle="pill" data-bs-target="#pills-mechanic" type="button">Automação</button>
                                </li>
                            </ul>

                            <div class="tab-content" id="pills-tabContent">
                                <div class="tab-pane fade show active" id="pills-general" role="tabpanel">
                                    <div class="row mb-2">
                                        <div class="col-8">
                                            <label class="text-secondary small">NOME</label>
                                            <input type="text" id="abilName" class="form-control bg-black text-light border-secondary">
                                        </div>
                                        <div class="col-4">
                                            <label class="text-secondary small">TIPO</label>
                                            <select id="abilCategory" class="form-select bg-black text-light border-secondary">
                                                <option value="CLASS">Classe</option>
                                                <option value="MAGIC">Magia</option>
                                                <option value="AWAKEN">Despertar</option>
                                                <option value="WEAPON">Arma</option>
                                                <option value="TRANSFORMATION">Transf.</option>
                                                <option value="SPECIAL">Especial</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="text-secondary small">AÇÃO</label>
                                        <input type="text" id="abilAction" class="form-control bg-black text-light border-secondary" placeholder="Ex: Ação Bônus">
                                    </div>
                                    <div class="mb-2">
                                        <label class="text-secondary small">DESCRIÇÃO</label>
                                        <textarea id="abilDesc" class="form-control bg-black text-light border-secondary" rows="5"></textarea>
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="pills-mechanic" role="tabpanel">
                                    <div class="p-2 border border-secondary rounded mb-3 bg-dark bg-opacity-25">
                                        <label class="text-info small fw-bold mb-2"><i class="fa-solid fa-arrows-rotate"></i> SISTEMA DE USOS</label>
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="text-secondary small">Max. Usos</label>
                                                <input type="number" id="abilMaxUses" class="form-control bg-black text-light border-secondary text-center" value="1">
                                            </div>
                                            <div class="col-6">
                                                <label class="text-secondary small">Rolagem</label>
                                                <input type="text" id="abilDice" class="form-control bg-black text-light border-secondary" placeholder="Ex: 2d12">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="p-2 border border-secondary rounded mb-3 bg-dark bg-opacity-25">
                                        <label class="text-success small fw-bold mb-2"><i class="fa-solid fa-shield-halved"></i> EFEITO ATIVO (BUFF)</label>
                                        <div class="row">
                                            <div class="col-7">
                                                <label class="text-secondary small">Atributo Alvo</label>
                                                <select id="abilTarget" class="form-select bg-black text-light border-secondary small">
                                                    <option value="none">Nenhum</option>
                                                    <option value="defense">Defesa (Outros)</option>
                                                    <option value="defenseBase">Defesa (Base)</option>
                                                    <option value="armor">Armadura</option>
                                                    <option value="attrForca">Força</option>
                                                    <option value="attrDestreza">Destreza</option>
                                                </select>
                                            </div>
                                            <div class="col-5">
                                                <label class="text-secondary small">Valor</label>
                                                <input type="number" id="abilEffectValue" class="form-control bg-black text-light border-secondary text-center" placeholder="0">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="p-2 border border-secondary rounded bg-dark bg-opacity-25">
                                        <label class="text-warning small fw-bold mb-2"><i class="fa-regular fa-clock"></i> DURAÇÃO</label>
                                        <div class="row align-items-center">
                                            <div class="col-12">
                                                <label class="text-secondary small">Dados de Turnos</label>
                                                <input type="text" id="abilDuration" class="form-control bg-black text-light border-secondary" placeholder="Ex: 1d4">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer border-secondary">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-purple" id="btnSaveAbility">Salvar Habilidade</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="activeEffectsPanel" class="position-fixed top-50 end-0 translate-middle-y p-3 rounded-start bg-dark border border-secondary border-end-0 shadow" 
    style="width: 250px; z-index: 1000; display: none;">
    
            <h6 class="text-warning border-bottom border-secondary pb-2 mb-3 text-center">
                <i class="fa-solid fa-bolt"></i> EFEITOS ATIVOS
            </h6>
            
            <div id="effectsList" class="d-flex flex-column gap-2 mb-3" style="max-height: 300px; overflow-y: auto;">
                </div>

            <button id="btnNextTurn" class="btn btn-sm btn-outline-light w-100">
                <i class="fa-solid fa-hourglass-half"></i> PASSAR TURNO
            </button>
        </div>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="assets/js/ApiService.js" defer></script>
    <script src="assets/js/DiceRoll.js"></script>
    <script src="assets/js/Attack.js"></script>
    <script src="assets/js/Defense.js"></script>
    
    <script src="assets/js/Abilities.js"></script>
    
    <script src="assets/js/Sheet.js" defer></script>
</body>
</html>